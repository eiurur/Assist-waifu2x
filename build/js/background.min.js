$(function(){var clickHandler,syncGet;return syncGet=function(key){return new Promise(function(resolve,reject){return chrome.storage.sync.get(key,function(item){return resolve(item.key)})})},clickHandler=function(info,tab){return chrome.storage.sync.get("aw2x_noise",function(item){return info.noise=item.aw2x_noise,chrome.storage.sync.get("aw2x_scale",function(item){var uid;return info.scale=item.aw2x_scale,uid=Date.now(),chrome.tabs.create({url:"../build/views/views/asyncpost.html?uid="+uid+"&srcUrl="+info.srcUrl+"&noise="+info.noise+"&scale="+info.scale,active:!1},function(tab){return void 0})})})},chrome.contextMenus.create({title:"image to waifu2x",contexts:["image"],id:"image"}),chrome.contextMenus.onClicked.addListener(clickHandler),chrome.runtime.onMessage.addListener(function(request,sender,sendResponse){return chrome.tabs.getAllInWindow(null,function(tabs){return tabs.forEach(function(tab){return"success"===request.status&&-1!==tab.url.indexOf(request.uid)&&setTimeout(function(){return chrome.tabs.remove(tab.id,function(){return void 0})},1e3),"failure"===request.status&&-1!==tab.url.indexOf(request.uid)?setTimeout(function(){return chrome.tabs.remove(tab.id,function(){return void 0})},1e3):void 0})})})});