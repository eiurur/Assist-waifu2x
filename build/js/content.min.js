!function(){var convert,getUrlVars,post2CorsServer,qs,saveBlobImage;return convert={base64toBlob:function(_base64){var arr,blob,data,i,mime,tmp;for(i=void 0,tmp=_base64.split(","),data=atob(tmp[1]),mime=tmp[0].split(":")[1].split(";")[0],arr=new Uint8Array(data.length),i=0;i<data.length;)arr[i]=data.charCodeAt(i),i++;return blob=new Blob([arr],{type:mime}),Blob},toArrayBuffer:function(buffer){var ab,i,view;for(ab=new ArrayBuffer(buffer.length),view=new Uint8Array(ab),i=0;i<buffer.length;)view[i]=buffer[i],++i;return ab}},saveBlobImage=function(data){var arrayBuffer,blob,filename;return arrayBuffer=convert.toArrayBuffer(data.body.data),blob=new Blob([arrayBuffer],{type:data.type}),filename=Date.now()+".png",saveAs(blob,filename)},post2CorsServer=function(params){return $.ajax({type:"POST",url:"https://tk2-207-13331.vs.sakura.ne.jp:3000/api/downloadFromURL",data:params,headers:{"Access-Control-Allow-Origin":"*"}}).done(function(data){return data.error?void 0:(saveBlobImage({body:data.body,type:data.type}),void chrome.runtime.sendMessage({uid:qs.uid,status:"success"},function(response){return void 0}))}).fail(function(jqXHR,textStatus){return void chrome.runtime.sendMessage({uid:qs.uid,status:"fail"},function(response){return void 0})})},getUrlVars=function(){var i,key,keySearch,param,val,vars;for(vars={},param=location.search.substring(1).split("&"),i=0;i<param.length;)keySearch=param[i].search(RegExp("=")),key="",-1!==keySearch&&(key=param[i].slice(0,keySearch)),val=param[i].slice(param[i].indexOf("=",0)+1),""!==key&&(vars[key]=decodeURI(val)),i++;return vars},qs=getUrlVars(),post2CorsServer({url:qs.srcUrl,noise:2,scale:2})}();